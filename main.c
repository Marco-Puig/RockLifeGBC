#include <gb/gb.h>
#include <gb/cgb.h>
#include <stdint.h>
#include <gbdk/platform.h>
#include <gbdk/metasprites.h>

#define single_player_world_TILE_ORIGIN 0
#define single_player_world_TILE_H 8
#define single_player_world_WIDTH 160
#define single_player_world_HEIGHT 144
#define single_player_world_TILE_COUNT 35
#define single_player_world_MAP_ATTRIBUTES single_player_world_map_attributes
#define single_player_world_TILE_PALS 0
#define single_player_world_PALETTE_COUNT 4

BANKREF_EXTERN(single_player_world)

extern const palette_color_t single_player_world_palettes[24];
extern const uint8_t single_player_world_tiles[560];

extern const unsigned char single_player_world_map[360];
extern const unsigned char single_player_world_map_attributes[360];

BANKREF(single_player_world)

const palette_color_t single_player_world_palettes[24] = {
	RGB8(255, 255, 255), RGB8(89, 192, 137), RGB8(64, 126, 201), RGB8(61, 124, 202),
	RGB8(255, 255, 255), RGB8(89, 192, 137), RGB8(16, 164, 51), RGB8(15, 92, 46),
	RGB8(89, 192, 137), RGB8(106, 111, 115), RGB8(15, 92, 46), RGB8(54, 23, 6),
	RGB8(89, 192, 137), RGB8(143, 144, 139), RGB8(106, 111, 115), RGB8(16, 164, 51),
	RGB8(89, 192, 137), RGB8(16, 164, 51), RGB8(54, 23, 6), RGB8(97, 1, 0),
	RGB8(106, 111, 115), RGB8(16, 164, 51), RGB8(15, 92, 46), RGB8(0, 0, 0)
};

const uint8_t single_player_world_tiles[560] = {
	0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0x1f,0xff,0x1f,0xff,0x1f,0xff,0x1f,0xff,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
	0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,
	0x00,0xf0,0x00,0xf0,0x00,0xf0,0x00,0xf0,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xf0,0x00,0xf0,0x00,0xf0,0x00,0xf0,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xff,0x00,0xff,0x00,0xff,0x00,0xff,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x0f,0xff,0x0f,0xff,0x0f,0xff,0x0f,0xff,
	0x00,0xf0,0x00,0xf0,0x00,0xf0,0x00,0xf0,0x0f,0xff,0x0f,0xff,0x0f,0xff,0x0f,0xff,
	0xff,0x00,0xff,0x00,0xff,0x00,0xff,0x00,0xff,0x00,0xff,0x00,0xff,0x00,0xff,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xff,0x00,0xff,0x00,0xff,0x00,0xff,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xf0,0x0f,0xf0,0x0f,0xf0,0x0f,0xf0,0x0f,
	0x0f,0x00,0x0f,0x00,0x0f,0x00,0x0f,0x00,0xff,0x00,0xff,0x00,0xff,0x00,0xff,0x00,
	0x00,0x0f,0x00,0x0f,0x00,0x0f,0x00,0x0f,0xff,0x00,0xff,0x00,0xff,0x00,0xff,0x00,
	0x0f,0xff,0x0f,0xff,0x0f,0xff,0x0f,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
	0x0f,0xff,0x0f,0xff,0x0f,0xff,0x0f,0xff,0x0f,0xff,0x0f,0xff,0x0f,0xff,0x0f,0xff,
	0x00,0xff,0x00,0xff,0x00,0xff,0x00,0xff,0xf0,0xff,0xf0,0xff,0xf0,0xff,0xf0,0xff,
	0xff,0x00,0xff,0x00,0xff,0x00,0xff,0x00,0xf0,0x0f,0xf0,0x0f,0xf0,0x0f,0xf0,0x0f,
	0xff,0x00,0xff,0x00,0xff,0x00,0xff,0x00,0x00,0xff,0x00,0xff,0x00,0xff,0x00,0xff,
	0xf0,0x0f,0xf0,0x0f,0xf0,0x0f,0xf0,0x0f,0x0f,0xff,0x0f,0xff,0x0f,0xff,0x0f,0xff,
	0xff,0xf0,0xff,0xf0,0xff,0xf0,0xff,0xf0,0x0f,0xf0,0x0f,0xf0,0x0f,0xf0,0x0f,0xf0,
	0xff,0x0f,0xff,0x0f,0xff,0x0f,0xff,0x0f,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
	0xff,0x0f,0xff,0x0f,0xff,0x0f,0xff,0x0f,0xff,0x00,0xff,0x00,0xff,0x00,0xff,0x00,
	0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0x00,0xff,0x00,0xff,0x00,0xff,0x00,
	0x00,0xff,0x00,0xff,0x00,0xff,0x00,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
	0x0f,0x0f,0x0f,0x0f,0x0f,0x0f,0x0f,0x0f,0x0f,0x0f,0x0f,0x0f,0x0f,0x0f,0x0f,0x0f,
	0x00,0xf0,0x00,0xf0,0x00,0xf0,0x00,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,0xf0,
	0x00,0xff,0x00,0xff,0x00,0xff,0x00,0xff,0x00,0xff,0x00,0xff,0x00,0xff,0x00,0xff,
	0x00,0xff,0x00,0xff,0x00,0xff,0x00,0xff,0x0f,0xf0,0x0f,0xf0,0x0f,0xf0,0x0f,0xf0,
	0x00,0xf0,0x00,0xf0,0x00,0xf0,0x00,0xf0,0x0f,0xf0,0x0f,0xf0,0x0f,0xf0,0x0f,0xf0,
	0x0f,0xf0,0x0f,0xf0,0x0f,0xf0,0x0f,0xf0,0x0f,0xf0,0x0f,0xf0,0x0f,0xf0,0x0f,0xf0,
	0x0f,0xf0,0x0f,0xf0,0x0f,0xf0,0x0f,0xf0,0x0f,0x00,0x0f,0x00,0x0f,0x00,0x0f,0x00,
	0xf0,0xff,0xf0,0xff,0xf0,0xff,0xf0,0xff,0x0f,0xff,0x0f,0xff,0x0f,0xff,0x0f,0xff
};

const unsigned char single_player_world_map[360] = {
	0x00,0x01,0x02,0x00,0x00,0x03,0x00,0x03,0x01,0x04,0x04,0x04,0x04,0x04,0x04,0x04,0x04,0x05,0x01,0x01,
	0x03,0x03,0x00,0x06,0x00,0x03,0x03,0x03,0x03,0x04,0x05,0x03,0x03,0x04,0x04,0x04,0x04,0x05,0x03,0x03,
	0x01,0x01,0x05,0x05,0x01,0x04,0x05,0x04,0x04,0x04,0x05,0x03,0x03,0x05,0x04,0x04,0x03,0x03,0x03,0x03,
	0x04,0x04,0x04,0x03,0x03,0x00,0x05,0x01,0x01,0x01,0x01,0x04,0x04,0x04,0x05,0x01,0x03,0x03,0x03,0x03,
	0x07,0x03,0x01,0x00,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x03,0x04,0x04,0x03,0x03,0x03,0x08,0x09,0x0a,
	0x0b,0x0c,0x0d,0x08,0x08,0x03,0x03,0x03,0x03,0x03,0x07,0x0e,0x0b,0x0b,0x0c,0x0c,0x0f,0x10,0x10,0x04,
	0x0b,0x0b,0x10,0x11,0x12,0x0c,0x0b,0x0c,0x0c,0x0b,0x0b,0x0b,0x0b,0x0b,0x13,0x14,0x14,0x10,0x04,0x04,
	0x0b,0x15,0x04,0x04,0x04,0x16,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x17,0x04,0x11,0x04,0x04,0x10,
	0x18,0x19,0x19,0x17,0x19,0x18,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0b,0x18,0x17,0x1a,0x04,0x04,0x19,
	0x0b,0x0b,0x0b,0x1b,0x0b,0x0b,0x0b,0x0b,0x0b,0x0e,0x0b,0x07,0x0b,0x0b,0x0b,0x18,0x04,0x04,0x1c,0x0b,
	0x14,0x1d,0x1d,0x00,0x14,0x14,0x14,0x14,0x0a,0x1e,0x1e,0x0b,0x11,0x12,0x1d,0x1d,0x14,0x1a,0x1f,0x14,
	0x10,0x1a,0x1a,0x12,0x1d,0x12,0x1d,0x1d,0x0b,0x20,0x0b,0x20,0x0b,0x1d,0x1d,0x12,0x12,0x12,0x12,0x1d,
	0x1a,0x1a,0x10,0x04,0x04,0x1a,0x1d,0x12,0x0b,0x20,0x0b,0x20,0x0b,0x12,0x12,0x12,0x1d,0x1d,0x12,0x12,
	0x1d,0x1a,0x10,0x1a,0x1d,0x12,0x10,0x0b,0x0b,0x0b,0x14,0x1e,0x0b,0x0b,0x21,0x12,0x12,0x12,0x12,0x1d,
	0x1d,0x1a,0x10,0x1a,0x1d,0x1d,0x11,0x0b,0x12,0x0b,0x0b,0x1a,0x0b,0x0b,0x21,0x12,0x12,0x22,0x12,0x1d,
	0x1d,0x1d,0x12,0x11,0x22,0x12,0x1d,0x1d,0x1d,0x12,0x12,0x1d,0x1d,0x12,0x1d,0x22,0x1d,0x1d,0x12,0x1d,
	0x1d,0x12,0x12,0x1d,0x11,0x1d,0x12,0x1d,0x12,0x12,0x1d,0x12,0x12,0x1d,0x1d,0x22,0x12,0x12,0x1d,0x1d,
	0x1d,0x12,0x1d,0x1d,0x1d,0x1d,0x1d,0x1d,0x12,0x1d,0x12,0x1d,0x12,0x12,0x1d,0x12,0x12,0x1d,0x1d,0x1d,
};

const unsigned char single_player_world_map_attributes[360] = {
	0x00,0x00,0x00,0x00,0x20,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x60,0x00,0x40,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x40,0x00,0x00,
	0x60,0x60,0x60,0x00,0x00,0x00,0x60,0x00,0x00,0x00,0x40,0x00,0x00,0x20,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x20,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x01,0x01,
	0x00,0x00,0x01,0x01,0x01,0x00,0x00,0x00,0x00,0x00,0x20,0x00,0x00,0x00,0x00,0x00,0x01,0x01,0x21,0x01,
	0x00,0x00,0x01,0x01,0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x01,0x01,0x41,0x01,0x01,
	0x00,0x01,0x01,0x01,0x01,0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x01,0x01,0x01,0x01,0x21,
	0x01,0x01,0x01,0x41,0x01,0x21,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x41,0x01,0x01,0x01,0x01,
	0x00,0x00,0x00,0x02,0x00,0x00,0x00,0x00,0x00,0x02,0x02,0x02,0x00,0x00,0x00,0x01,0x01,0x01,0x02,0x00,
	0x01,0x01,0x01,0x22,0x01,0x01,0x01,0x01,0x23,0x03,0x23,0x02,0x03,0x21,0x01,0x01,0x01,0x61,0x04,0x01,
	0x21,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x02,0x03,0x03,0x23,0x02,0x01,0x01,0x41,0x41,0x01,0x41,0x01,
	0x61,0x61,0x41,0x01,0x01,0x61,0x01,0x43,0x02,0x03,0x03,0x23,0x02,0x63,0x21,0x21,0x01,0x01,0x41,0x61,
	0x01,0x01,0x01,0x61,0x01,0x01,0x63,0x02,0x02,0x02,0x03,0x63,0x02,0x02,0x05,0x01,0x61,0x01,0x01,0x01,
	0x01,0x61,0x41,0x61,0x01,0x01,0x23,0x02,0x23,0x02,0x02,0x03,0x02,0x02,0x45,0x21,0x01,0x01,0x01,0x01,
	0x01,0x01,0x21,0x01,0x21,0x21,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x21,0x01,0x21,0x01,0x01,0x01,0x01,
	0x01,0x61,0x21,0x01,0x21,0x01,0x21,0x01,0x61,0x21,0x01,0x41,0x21,0x01,0x01,0x21,0x21,0x61,0x01,0x01,
	0x01,0x41,0x01,0x01,0x01,0x01,0x01,0x01,0x41,0x01,0x61,0x01,0x41,0x41,0x01,0x41,0x61,0x01,0x01,0x01,
};

void main(void)
{
    DISPLAY_ON;
    SHOW_BKG;

    // Populate VRAM with our tile data
    set_bkg_data(0,single_player_world_TILE_COUNT,single_player_world_tiles);

    // The "single_player_world_palettes" color palettes is defined in single_player_world.c
    set_bkg_palette(0,single_player_world_PALETTE_COUNT,single_player_world_palettes);

    // Set the attributes using VRAM bank 1
    // Specifically, which color palette to use
    VBK_REG=1;
    set_bkg_tiles(0,0,20,18,single_player_world_map_attributes);

    // Switch back to bank 0 to prevent accidentally writing to bank 1
    VBK_REG=0;
    set_bkg_tiles(0,0,20,18,single_player_world_map);

    // Loop forever
    while(1) {
		// Game main loop processing goes here


		// Done processing, yield CPU and wait for start of next frame
        wait_vbl_done();
    }
}